UPDATE Computers INNER JOIN plugin_warrantymaster_aux ON (Computers.ComputerId=plugin_warrantymaster_aux.ComputerId) INNER JOIN inv_operatingsystem ON (Computers.ComputerId=inv_operatingsystem.ComputerId) SET Computers.WarrantyEnd = plugin_warrantymaster_aux.ExpiryDate WHERE ((((IF(INSTR(computers.os, 'server')>0, 1, 0)=0) AND (DATE(Computers.WarrantyEnd) < DATE('0001/01/01'))))) AND plugin_warrantymaster_aux.ExpiryDate <> ''; UPDATE Computers INNER JOIN plugin_warrantymaster_aux ON (Computers.ComputerId=plugin_warrantymaster_aux.ComputerId) INNER JOIN inv_operatingsystem ON (Computers.ComputerId=inv_operatingsystem.ComputerId) SET Computers.Assetdate = plugin_warrantymaster_aux.PurchaseDate WHERE ((((IF(INSTR(computers.os, 'server')>0, 1, 0)=0)))) AND plugin_warrantymaster_aux.PurchaseDate <> ''